<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
    <title>Připojování k databázi</title>
  </head>
  <body>
  <h1>Připojování k databázi a Odhlašování od databáze</h1>


  	<p>
	Před započetím práce s Plantlore je zapotřebí se přihlásit k databázi, se kterou chcete pracovat.
	</p>


	<h2>Obsah</h2>

	<p>
	<ol>
		<li>Proces připojení k databázi</li>
		<li>Vytváření záznamů o databázi</li>
		<li>Úprava a mazání záznamů o databázi</li>
		<li>Nejčastější problémy při připojování</li>
		<li>Odhlášení od databáze</li>
		<li>Obnova ztraceného připojení</li>
	</ol>
	</p>


	<h2>1. Proces připojení k databázi</h2>

	<p>
	Přihlášení k databázi, kde jsou Vaše data uložena, probíhá ve dvou krocích.
	</p>

	<h3>1.1. Výběr databáze</h3>
	
	<p>
	<img src="picture/LoginDBSelection.png" alt="Volba databáze.">
	</p>

	<p>
	Po instalaci Plantlore je k disposici jedna databáze pojmenovaná "Ukázková databáze".
	Tato databáze neobsahuje žádná nálezová data a je připravena pro započetí práce.
	Neobsahuje-li seznam databází žádný záznam, budete jej muset vytvořit - o tom pojednává
	druhá část této nápovědy.
	</p>

	<p>
	Po jisté době používání Plantlore může váš seznam databází vypadat podobně jako ten na obrázku.
	Plantlore automaticky předvolí tu databázi, kterou jste zvolili při posledním přihlašování.
	Vyberte jednu z databází v seznamu a stiskněte tlačítko "Pokračuj".
	</p>


	<h3>1.2. Autentifikace - prokazování totožnosti</h3>

	<p>
	Pro přihlášení k databázi je potřeba se prokázat přihlašovacími údaji 
	- uživatelským jménem a heslem. 

	Pokud se přihlašujete poprvé, zadejte přihlašovací údaje, 
	které jste použili při instalaci Plantlore.

	Nové uživatelské jméno a heslo smí z bezpečnostních důvodů přidělit pouze administrátor databáze.
	Často i zkušení uživatelé používají velmi slabá hesla, proto je jejich přidělování
	přenecháno jemu.
	</p>
	
	<p>
	<img src="picture/LoginAuthentication.png" alt="Vkládání přihlašovacích údajů.">
	</p>

	<p>
	Plantlore si pamatuje několik posledních uživatelských jmen vkládaných při přihlášování;
	můžete vybrat jedno z připraveného seznamu, nebo zadat jiné uživatelské jméno.
	Hesla Plantlore neukládá a automaticky je nikdy nenabízí.
	Po zadání údajů stiskněte tlačítko "Přihlásit". 
	</p>

	<p>
	Stiskem tlačítka "Přihlásit" se Plantlore pokusí připojit k vybrané databázi se zadanými
	přihlašovacími údaji. Připojení může (zejména pokud se připojujete ke vzdálené databázi)
	trvat delší dobu.
	</p>


	<p>
	Pokud se přihlášení z nějakého důvodu nezdaří, budete o tom informováni krátkou zprávou.
	V opačném případě Plantlore zobrazí základní <a href="./overview.html">Přehled</a>.
	</p>


	<h2 id="AddDBInfo">2. Vytváření záznamů o databázích</h2>

	<p>
	Chcete-li se připojit k jiné databázi, 
	kterou jste sami vytvořili nebo kterou vytvořil někdo jiný na svém počítači,
	musíte vytvořit nový záznam, který popisuje, kde se databáze nachází a jak je nastavena.
	</p>

	<p>
	Kontextové menu pro vytvoření, upravení nebo vymazání záznamu lze vyvolat stiskem pravého
	tlačítka myši. Vyberte položku "Přidat" a klikněte na ni.
	</p>

	<p>
	<img src="picture/LoginAddMenu.png" alt="Přidání nového záznamu.">
	</p>

	<p>
	Přidání nového záznamu pro připojení k databázi je rozděleno na dvě části, 
	jimž odpovídají dvě záložky na dialogu. 
	<ul>
		<li>
		První z nich je <b>přímé připojení</b>, též lokální připojení. 
		Přímé připojení k databázi lze použít pouze v případě,
		že vytvořená databáze se nachází v databázovém stroji (database engine), který běží na
		tomto počítači, tzv. lokálně. Přímé připojení vyžaduje poněkud odlišné parametry než 
		připojení ke vzdálené databázi. Výhodou přímého připojení je jeho rychlost - komunikace
		s databází se nemusí nijak upravovat pro přenos po síti.
		</li>
		<li>
		Druhá možnost je tzv. <b>vzdálené připojení</b>, připojení ke vzdálené databázi.
		Vzdálená databáze se typicky nachází v databázovém stroji (database engine), který je
		spuštěn na jiném počítači v síti. Pomocí tohoto připojení je možné pracovat s databází
		"na dálku". Nevýhodou je zpomalení dané jednak propustností datové linky a jednak 
		nutností speciálně upravovat přenášená data kvůli přenosu po síti. 
		</li>
	</ul>
	</p>


	<h3>A. Přímé připojení k databázi (lokální připojení)</h3>

	<p>
	Parametry popisující přímé připojení:
	<table>
		<tr>
			<th>Název</th>
			<th>Význam</th>
		</tr>
		<tr>
			<td>Alias</td>
			<td>
				Alias je krátký řetězec, který umožňuje snadnou identifikaci databáze uživatelem.
				Tento řetězec je zobrazován v seznamu databází. Měl by být krátký a výstižný,
				například: "Domácí databáze", "Projekt mapování Českého středohoří".
			</td>
		</tr>
		<tr>
			<td>Databázový stroj (engine)</td>
			<td>
				Existuje několik databázových strojů (database engine), které umožňují snadnou
				práci s databázemi, tabulkami, uživateli, dotazy a daty.
				Každý databázový stroj může obsahovat několik různě pojmenovaných databází
				s různou strukturou a s různým obsahem. Mezi nejznámější databázové stroje
				patří Oracle, MSSQL, MySQL, Postgre a Firebird.
				Plantlore podporuje práci s různými databázovými stroji,
				ale je nutné přesně specifikovat, o který se jedná, 
				aby s ním bylo možné bezchybně komunikovat. Plantlore je standardně dodávána
				s Postgre. Aktuálně podporované DB stroje jsou sepsány v rozbalovací
				nabídce, ale je možné specifikovat i jiný.
			</td>
		</tr>
		<tr>
			<td>Identifikátor DB</td>
			<td>
				Databázový stroj může obsahovat několik různých databází s různou strukturou
				a obsahem. Databáze Plantlore mají vlastní specifickou strukturu. 
				Pro správné připojení je nutné vyplnit identifikátor (jméno)
				databáze, se kterou chce pracovat.
			</td>
		</tr>
		<tr>
			<td>Port DB</td>
			<td>
				Databázové stroje umožňují připojení pouze přes tzv. port. Každý databázový
				stroj má tento port jiný a navíc jej lze snadno změnit. Aby Plantlore věděl,
				kde má databázový stroj kontaktovat, musí znát port, na kterém stroj naslouchá.
				Port je číslo v rozsahu 0 až 65.535, přičemž je běžné, že databázové stroje
				využívají porty v rozsahu 1.024 a výše. Například standardní port databázového
				stroje Postgre je 5432.
			</td>
		</tr>
		<tr>
			<td>Parametr</td>
			<td>
				Databázový stroj může být potřeba ještě nakonfigurovat nějakým specifickým
				způsobem. Některé stroje například vyžadují explicitní nastavení kódování
				znaků. Parametr slouží
				pro správné nastavení dodatečných parametrů připojení k databázovému stroji.
				Připojení k Postgre žádný parametr nevyžaduje.
				<br/>
				<i>Odborné: parametr je hodnota předávaná v připojovacím JDBC řetězci za "?".</i>
			</td>
		</tr>
	</table>
	</p>

	<p>
	Na ukázku uveďme, jak by vypadalo lokální připojení k databázi nazvané "plantlore",
	která je uložena v databázovém stroji "Postgre", který naslouchá na portu "5432".
	</p>

	<p>
	<img src="picture/LoginDBDirectConnection.png" alt="Přidání nového záznamu.">
	</p>


	<h3>B. Vzdálené připojení k databázi</h3>

	<p>
	Parametry popisující vzdálené připojení:
	<table>
		<tr>
			<th>Název</th>
			<th>Význam</th>
		</tr>
		<tr>
			<td>Alias</td>
			<td>
				Alias je krátký řetězec, který umožňuje snadnou identifikaci databáze uživatelem.
				Tento řetězec je zobrazován v seznamu databází. Měl by být krátký a výstižný,
				například: "Oficiální databáze Jihočeské pobočky ČBS".
			</td>
		</tr>
		<tr>
			<td>Host</td>
			<td>
				Databázový stroj obsahující databázi, k níž se chceme připojit, běží na jiném
				počítači v síti. Tento parametr identifikuje tento počítač a to buď podle
				jeho jména nebo IP adresy. Každý počítač připojený k síti musí mít
				svou vlastní unikátní IP adresu, podle níž je rozpoznán. IP adresa je 
				nejčastěji čtveřice čísel oddělená tečkami, např. "192.168.0.247".
				Některé počítače mají kromě IP adresy přidělena i jména, např. 
				"data.domacisit.cz". Cílový počítač lze identifikovat 
				oběma způsoby.
			</td>
		</tr>
		<tr>
			<td>Port</td>
			<td>
				Aby bylo možné se připojit ke vzdálenému databázovému stroji, je nutné
				na uvedeném vzdáleném počítači kontaktovat 
				<a href="./server.html">Plantlore Server</a>, což je speciální
				aplikace, která má za úkol zprostředkovávat připojení vzdáleným klientům a
				dohlížet na počet připojených uživatelů. Tato služba musí být přístupná
				na vzdáleném počítači, kde se nachází i vzdálený databázový stroj, 
				a naslouchá na nějakém portu. Standardní port, na kterém je tato služba
				dostupná, je 1099.
			</td>
		</tr>
		<tr>
			<td>Identifikátor DB</td>
			<td>
				Databázový stroj může obsahovat několik různých databází s různou strukturou
				a obsahem. Databáze Plantlore mají vlastní specifickou strukturu. 
				Pro správné připojení je nutné vyplnit identifikátor
				databáze, se kterou chce pracovat.
			</td>
		</tr>
	</table>
	</p>
	
	<p>
	Na ukázku uveďme, jak by vypadalo nastavení pro vzdálené připojení k databázi nazvané "plantlore",
	která je uložena v databázovém stroji, 
	který se nachází na počítači s adresou "192.168.0.247", 
	a Plantlore Server naslouchá na portu "1099".
	</p>

	<p>
	<img src="picture/LoginDBRemoteConnection.png" alt="Přidání nového záznamu.">
	</p>


	<p>
	<b>
		Přidáváte-li nový záznam, žádná nová databáze se nikde nevytváří; vytváří se pouze
		reference (odkaz) na nějakou existující databázi.
	</b>
	</p>



	<h2>3. Úprava a mazání záznamů o databázi</h2>

	<p>
	V seznamu databází označte záznam, který chcete upravit nebo smazat.
	Kontextové menu pro vytvoření, upravení nebo vymazání záznamu lze vyvolat stiskem pravého tlačítka myši. 
	Vyberte položku "Editovat" nebo "Odstranit" a klikněte na ni.
	</p>

	<p>
	<img src="picture/LoginEditMenu.png" alt="Úprava stávajícího záznamu.">
	</p>

	<p>
	Úprava záznamů je shodná s dialogem pro přidání záznamu, ale obsahuje předvyplněné hodnoty.
	Detailní popis lze najít v předcházející části.
	</p>

	<p>
	Odstranění záznamu další nastavení nemá.
	</p>

	<p>
	<img src="picture/LoginDeleteMenu.png" alt="Vymazání existujícího záznamu.">
	</p>


	<p>
	<b>
		Mažete-li existující záznam, žádná databáze se nikde nemaže; ruší se pouze
		reference (odkaz) na nějakou existující databázi.
	</b>
	</p>



	<h2>4. Nejčastější problémy při připojování</h2>

	<p>
	Nejčastější problémy při připojování jsou tyto:
	<ol>
		<li>
		Nesprávně vyplněné přihlašovací údaje - uživatelské jméno nebo špatně zadané heslo.
		Ověřte, zda jste správně zadali oba údaje, případně zda máte vytvořený
		odpovídající uživatelský účet v databázi, k níž se připojujete.
		</li>
		<li>
		Nesprávně zadané parametry pro přímé nebo vzdálené připojení k databázi.
		Ověřte, zda jsou vyplněny všechny položky správně a zda obsahují aktuální data. 
		Např. mohlo dojít ke změně IP adresy počítače, ke kterému se přihlašujete, nebo jste
		udělali překlep při zadávání identifikátoru databáze.
		</li>
		<li>
		Vypnutý databázový stroj nebo Plantlore Server.
		Ověřte, že databázový stroj je zapnutý, resp. se ujistěte, že na vzdáleném počítači
		je spuštěn Plantlore Server.
		</li>
	</ol>
	</p>



	<h2>5. Odhlášení od databáze</h2>

	<p>
	Po skončení práce s databází je doporučeno se odhlásit, aby třetí osoba nezískala možnost
	pracovat s vašimi daty. Odhlášení provedete buď v menu položkou "Odhlásit" nebo
	vypnutím Plantlore. Oba způsoby jsou ekvivalentní.
	</p>


	<h2>6. Obnova ztraceného připojení</h2>

	<p>
	Při práci s Plantlore může dojít k náhlé ztrátě připojení k databázi nebo vzdálenému serveru.
	Důvodem může být neočekávané vypnutí nebo pád databázového stroje nebo Serveru či výpadek síťového spojení.
	O tomto stavu jste informováni krátkou zprávou, která popisuje problém, ke kterému došlo.
	V případě ztraceného spojení s databází nebo Serverem vyčkejte nějakou dobu a zkuste 
	v menu vybrat "Znovu připojit". Plantlore se pokusí navázat nové spojení. 
	"Znovu připojit" můžete volat opakovaně.
	</p>


  </body>
</html>
